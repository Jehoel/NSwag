{% if parameter.IsDateArray -%}
foreach (var item_ in {{ parameter.VariableName }}) { urlBuilder_.Append("{{ parameter.Name }}=").Append(Uri.EscapeDataString(item_.ToString("{{ ParameterDateTimeFormat }}", CultureInfo.InvariantCulture))).Append("&"); }
{% elseif parameter.IsDate -%}
urlBuilder_.Append("{{ parameter.Name }}=").Append(Uri.EscapeDataString({% if parameter.IsNullable and parameter.IsRequired %}{{ parameter.VariableName }} != null ? {% endif %}{{ parameter.VariableName }}{% if parameter.IsSystemNullable %}.Value{% endif %}.ToString("{{ ParameterDateTimeFormat }}", CultureInfo.InvariantCulture){% if parameter.IsNullable and parameter.IsRequired %} : "{{ QueryNullValue }}"{% endif %})).Append("&");
{% elseif parameter.IsArray -%}
foreach (var item_ in {{ parameter.VariableName }}) { urlBuilder_.Append("{{ parameter.Name }}=").Append(Uri.EscapeDataString(ConvertToString(item_, CultureInfo.InvariantCulture))).Append("&"); }
{% elseif parameter.IsDeepObject -%}
{%     for property in parameter.PropertyNames -%}
if ({{parameter.Name}}.{{property}} != null)
{
    urlBuilder_.Append("{{parameter.Name}}[{{property}}]=").Append(Uri.EscapeDataString(ConvertToString({{parameter.Name}}.{{property}}, CultureInfo.InvariantCulture))).Append("&");
}
{%     endfor -%}
{%     for property in parameter.CollectionPropertyNames -%}
if ({{parameter.Name}}.{{property}} != null && {{parameter.Name}}.{{property}}.Count > 0)
{
    urlBuilder_.Append("{{parameter.Name}}[{{property}}]=");
    foreach (var p_ in {{parameter.Name}}.{{property}})
    {
        urlBuilder_.Append(Uri.EscapeDataString(ConvertToString(p_, CultureInfo.InvariantCulture))).Append(",");
    }
    urlBuilder_.Length--;
    urlBuilder_.Append("&");
}
{%     endfor -%}
{% else -%}
urlBuilder_.Append("{{ parameter.Name }}=").Append(Uri.EscapeDataString({% if parameter.IsNullable and parameter.IsRequired %}{{ parameter.VariableName }} != null ? {% endif %}ConvertToString({{ parameter.VariableName }}, CultureInfo.InvariantCulture){% if parameter.IsNullable and parameter.IsRequired %} : "{{ QueryNullValue }}"{% endif %})).Append("&");
{% endif -%}